<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus - Diagrama UML</title>
    <meta name="description" content="Diagrama de clases UML que muestra la arquitectura y relaciones principales de la aplicación Nexus.">
    
    <link rel="icon" type="image/png" href="../assets/logo.png">
    
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="../styles/uml-styles.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-icons-font@v13/font/simple-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <main class="uml-page-wrapper">
        <div class="uml-header-content">
            <a href="../moreinfo.html" class="back-button">
                <i class="fa-solid fa-arrow-left"></i> Volver al menú
            </a>
            <h1>Diagrama UML</h1>
        </div>

        <div class="uml-documentation">
            <h3>Introducción al Modelo de Datos</h3>
            <p>Este documento refleja la arquitectura orientada a objetos de Nexus. El sistema se basa en una clase padre <code>ACTOR</code> de la que heredan los distintos roles, y separa claramente la lógica de productos físicos (Segunda Mano) de las ofertas digitales.</p>

            <h3>1. Estructura de Actores</h3>
            
            <h4>Clase Base: ACTOR</h4>
            <p>Entidad principal que gestiona la autenticación y los datos comunes.</p>
            <ul>
                <li><strong>id:</strong> (Integer) Identificador único.</li>
                <li><strong>user:</strong> (String) Nombre de usuario.</li>
                <li><strong>email:</strong> (String) Correo electrónico.</li>
                <li><strong>password:</strong> (String) Contraseña cifrada.</li>
                <li><strong>fechaRegistro:</strong> (DateTime) Fecha de alta.</li>
                <li><strong>rol:</strong> (tiposRol) Discriminador de permisos.</li>
                <li><em>Métodos:</em> <code>registrarse(datos)</code>, <code>iniciarSesion(credenciales)</code>, <code>editarPerfil(datos)</code>.</li>
            </ul>

            <h4>Subclases (Herencia)</h4>
            <ul>
                <li><strong>ADMIN:</strong> Posee el atributo <code>nivelAcceso</code> (Integer) para gestión del sistema.</li>
                <li><strong>EMPRESA:</strong> Identificada por su <code>cif</code> (String) para gestiones fiscales y contratos.</li>
                <li><strong>USUARIO:</strong> El usuario estándar de la plataforma. Atributos extendidos:
                    <ul>
                        <li><code>telefono</code> (String), <code>esVerificado</code> (Boolean)</li>
                        <li><code>fotoPerfil</code> (String URL), <code>biografia</code> (String)</li>
                        <li><code>ubicacion</code> (String), <code>reputacion</code> (Integer)</li>
                    </ul>
                </li>
            </ul>

            <h3>2. Productos y Mercado</h3>

            <h4>PRODUCTO (Segunda Mano)</h4>
            <p>Artículos físicos gestionados directamente por los usuarios.</p>
            <ul>
                <li><strong>Atributos:</strong> <code>id</code>, <code>titulo</code>, <code>descripcion</code>, <code>precio</code>, <code>tipoOferta</code>.</li>
                <li><strong>Estado:</strong> <code>estadoProducto</code> (Enum).</li>
                <li><strong>Métodos:</strong> <code>publicar()</code>, <code>eliminar()</code>.</li>
                <li><em>Relación:</em> Publicado por 1 Usuario. Puede tener N Mensajes (Chat).</li>
            </ul>

            <h4>OFERTA (Digital/Externa)</h4>
            <p>Promociones de productos nuevos publicadas por cualquier Actor.</p>
            <ul>
                <li><strong>Atributos:</strong> <code>urlOferta</code>, <code>tienda</code>, <code>precioOferta</code>.</li>
                <li><strong>Opcionales:</strong> <code>precioOriginal</code>, <code>fechaExpiracion</code>.</li>
                <li><em>Relación:</em> Publicada por Actor (1:N). Tiene Comentarios (1:N).</li>
            </ul>

            <h3>3. Transacciones y Contratos</h3>

            <h4>COMPRA</h4>
            <p>Registro de la adquisición de un Producto de segunda mano.</p>
            <ul>
                <li><strong>Datos:</strong> <code>precioFinal</code> (Double), <code>fechaCompra</code> (Date).</li>
                <li><strong>Estado:</strong> <code>estadoCompra</code> (Enum).</li>
                <li><em>Relación:</em> Realizada por 1 Usuario sobre 1 Producto.</li>
            </ul>

            <h4>CONTRATO</h4>
            <p>Acuerdos comerciales entre Nexus y una Empresa.</p>
            <ul>
                <li><strong>Datos:</strong> <code>id</code>, <code>tipoContrato</code>.</li>
                <li><em>Relación:</em> Vinculado a 1 Empresa.</li>
            </ul>

            <h3>4. Interacción Social</h3>

            <h4>MENSAJE (Chat)</h4>
            <ul>
                <li><strong>Datos:</strong> <code>id</code>, <code>fechaCreacion</code>, <code>estaActivo</code>.</li>
                <li><em>Relación:</em> Escrito por Usuario (1:N). Pertenece a un Producto (contexto de venta).</li>
            </ul>

            <h4>COMENTARIO</h4>
            <ul>
                <li><strong>Datos:</strong> <code>id</code>, <code>texto</code>, <code>fecha</code>, <code>esReportado</code>.</li>
                <li><strong>Métodos:</strong> <code>reportar()</code>.</li>
                <li><em>Relación:</em> Realizado por Actor sobre una Oferta.</li>
            </ul>

            <h3>5. Enumeraciones (Enums)</h3>
            <p>Valores predefinidos para controlar los estados del sistema:</p>
            <ul>
                <li><strong>ENUM ESTADOPRODUCTO:</strong> <code>DISPONIBLE</code>, <code>RESERVADO</code>, <code>VENDIDO</code>.</li>
                <li><strong>ENUM ESTADOCOMPRA:</strong> <code>ACEPTADO</code>, <code>PENDIENTE</code>, <code>RECHAZADO</code>.</li>
                <li><strong>ENUM TIPOCONTRATO:</strong> <code>BANNER</code>, <code>PUBLICACION</code>.</li>
            </ul>
        </div>

        <div class="uml-diagram-container">
            <h2 class="uml-diagram-title styled-title">Esquema Gráfico <small>(Clic en la imagen para ampliar)</small></h2>
            
            <img src="../assets/UML.png" alt="Diagrama de Clases UML de Nexus" class="plantuml-diagram-image" id="umlImage">
        </div>
    </main>

    <div id="imageZoomModal" class="image-zoom-modal">
        <span class="close-button" id="closeModalButton">&times;</span>
        <img class="modal-content" id="zoomedImage" alt="Zoom Diagrama">
        <div id="caption" class="caption"></div>
    </div>

    <footer class="advanced-footer">
        <div class="footer-grid-container">
            <div class="footer-section footer-brand">
                <h3>Nexus.</h3>
                <p>Deja de buscar, empieza a encontrar.</p>
            </div>
            <div class="footer-section footer-links">
                <h3>Legal</h3>
                <ul>
                    <li><a href="../legal/terms.html">Términos de Servicio</a></li>
                    <li><a href="../legal/privacy.html">Política de Privacidad</a></li>
                </ul>
            </div>
            <div class="footer-section footer-social">
                <h3>Síguenos</h3>
                <div class="social-icons">
                    <a href="https://x.com/somosnexusapp" target="_blank"><i class="si si-x"></i></a>
                    <a href="https://www.instagram.com/somosnexusapp/" target="_blank"><i class="si si-instagram"></i></a>
                    <a href="https://www.tiktok.com/@nexusapp?lang=es" target="_blank"><i class="si si-tiktok"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Nexus App. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="../script/animations.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById("imageZoomModal");
            const img = document.getElementById("umlImage");
            const modalImg = document.getElementById("zoomedImage");
            const closeModalButton = document.getElementById("closeModalButton");

            let zoomLevel = 0; 

            if (img && modal && modalImg && closeModalButton) {
                // Abrir Modal
                img.onclick = function(){
                    modal.style.display = "flex"; 
                    modalImg.src = this.src;
                    modalImg.classList.remove('zoomed-further', 'zoomed-even-further');
                    zoomLevel = 0;
                    document.body.style.overflow = "hidden"; // Bloquear scroll
                }

                // Cerrar Modal
                const closeModal = () => {
                    modal.style.display = "none";
                    document.body.style.overflow = "auto";
                }

                closeModalButton.onclick = closeModal;
                
                // Cerrar al hacer clic fuera de la imagen
                modal.addEventListener('click', function(event) {
                    if (event.target === modal) closeModal();
                });

                // Zoom progresivo al hacer clic en la imagen
                modalImg.onclick = function(event) {
                     event.stopPropagation(); 
                     if (zoomLevel === 0) {
                         this.classList.add('zoomed-further');
                         zoomLevel = 1;
                     } else if (zoomLevel === 1) {
                         this.classList.remove('zoomed-further');
                         this.classList.add('zoomed-even-further');
                         zoomLevel = 2;
                     } else { 
                         this.classList.remove('zoomed-even-further');
                         zoomLevel = 0; 
                     }
                 }

                // Cerrar con ESC
                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape') closeModal();
                });
            }
        });
    </script>
</body>
</html>